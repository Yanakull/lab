---
## Front matter
title: "Отчёт по лабораторной работе №12"
subtitle: "Настройки сети в Linux"
author: "Руслан Алиев"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получить навыки настройки сетевых параметров системы.

# Выполнение

## Проверка конфигурации сети

1. Для получения административных прав была выполнена команда **su -**, после чего приглашение командной строки изменилось, что подтверждает переход в режим суперпользователя.  

2. Для отображения информации о сетевых интерфейсах и статистики пакетов использовалась команда **ip -s link**.  
   В выводе показаны интерфейсы **lo** (loopback) и **enp0s3**.  
   Интерфейс `lo` представляет собой виртуальный сетевой интерфейс, используемый для внутреннего обмена данными внутри системы.  
   Интерфейс `enp0s3` — это физический сетевой адаптер, подключённый к сети.  
   Отображены счётчики переданных и полученных пакетов, а также ошибки и потери.  

   ![Информация о сетевых интерфейсах](Screenshot_1.png){ #fig:001 width=80% }

3. Для получения информации о маршрутах использовалась команда **ip route show**.  
   Из вывода видно, что используется маршрут по умолчанию (`default via 10.0.2.2 dev enp0s3`), направляющий весь трафик через шлюз **10.0.2.2** по интерфейсу **enp0s3**.  
   Также указан локальный маршрут для сети **10.0.2.0/24**, что позволяет обмениваться данными внутри подсети.  

4. Для просмотра адресов интерфейсов была использована команда **ip addr show**.  
   Из вывода видно, что интерфейс **enp0s3** имеет IPv4-адрес **10.0.2.15/24** и маску подсети 255.255.255.0.  
   Интерфейс **lo** имеет адрес **127.0.0.1/8**, предназначенный для локальных соединений.  
   Основным сетевым адаптером устройства является **enp0s3**.  

5. Для проверки соединения с сетью Интернет выполнена команда **ping -c 4 8.8.8.8**.  
   Все четыре пакета успешно получены, потерь нет, среднее время отклика составило около 22 мс, что подтверждает корректную работу сетевого подключения.  

   ![Проверка соединения с Интернетом с помощью ping](Screenshot_2.png){ #fig:002 width=80% }

6. Дополнительный IP-адрес был добавлен к интерфейсу **enp0s3** командой:  
   **ip addr add 10.0.0.10/24 dev enp0s3**  

   После выполнения команда **ip addr show** подтвердила наличие нового адреса — **10.0.0.10**.  

   ![Добавление дополнительного IP-адреса](Screenshot_3.png){ #fig:003 width=80% }

7. Для сравнения вывода утилит **ip** и **ifconfig** была использована команда **ifconfig**.  
   Оба инструмента показывают одинаковую информацию о сетевых интерфейсах, включая MAC-адрес, IP-адрес, маску, статистику трафика и состояние соединения.  
   Разница заключается в формате вывода: `ip` является более современным инструментом, заменяющим `ifconfig`.  

   ![Вывод информации с помощью ifconfig](Screenshot_4.png){ #fig:004 width=80% }

8. Для отображения списка всех прослушиваемых системой портов использовалась команда **ss -tul**.  
   В выводе показаны активные TCP и UDP-соединения, включая порты служб **ssh**, **ftp**, **http**, **websm** и **tipp**.  
   Это позволяет оценить, какие сетевые службы запущены и ожидают подключения.  

   ![Список активных портов TCP и UDP](Screenshot_5.png){ #fig:005 width=80% }

## Управление сетевыми подключениями с помощью nmcli

1. Для начала были получены права администратора. Затем при помощи команды **nmcli connection show** был выведен список существующих сетевых подключений.  
   Отображены интерфейсы **enp0s3** (проводное подключение) и **lo** (loopback).  

   ![Список существующих подключений](Screenshot_6.png){ #fig:006 width=80% }

2. Было создано новое Ethernet-соединение с именем **dhcp** для интерфейса **enp0s3** командой:  
   **nmcli connection add con-name "dhcp" type ethernet ifname enp0s3**.  
   После этого система подтвердила успешное добавление соединения с динамическим получением IP-адреса.  

   Далее добавлено второе соединение с именем **static** для того же интерфейса, но со статическим IP-адресом **10.0.0.10/24** и шлюзом **10.0.0.1**.  
   Использовалась команда:  
   **nmcli connection add con-name "static" ifname enp0s3 autoconnect no type ethernet ip4 10.0.0.10/24 gw4 10.0.0.1**.  

3. Повторный вывод списка соединений (**nmcli connection show**) показал, что были добавлены два новых подключения — **dhcp** и **static**, при этом оба пока неактивны.  

4. Для активации статического подключения выполнена команда **nmcli connection up static**.  
   После успешного выполнения в списке соединений активным стало **static**, связанное с интерфейсом **enp0s3**.  
   Команда **ip addr** подтвердила наличие статического адреса **10.0.0.10/24** у интерфейса.  

   ![Активация статического подключения и проверка IP](Screenshot_7.png){ #fig:007 width=80% }

5. Для возврата к динамическому подключению DHCP выполнена команда **nmcli connection up dhcp**.  
   После активации в выводе **nmcli connection show** активным стало соединение **dhcp**, а команда **ip addr** подтвердила получение динамического адреса **10.0.2.15/24**.  

   ![Переключение обратно на DHCP-подключение](Screenshot_8.png){ #fig:008 width=80% }

В результате была продемонстрирована работа с сетевыми профилями **NetworkManager**: создание, активация и переключение между статическим и динамическим типами подключения.

## Изменение параметров соединения с помощью nmcli

1. Для начала было отключено автоматическое подключение для профиля **static** с помощью команды  
   **nmcli connection modify "static" connection.autoconnect no**.  
   Это позволяет избежать автоматической активации соединения при загрузке системы.  

2. Далее к профилю **static** был добавлен основной DNS-сервер с адресом **10.0.0.10**:  
   **nmcli connection modify "static" ipv4.dns 10.0.0.10**.  

3. Затем добавлен второй DNS-сервер **8.8.8.8**, используя оператор `+`, чтобы новый адрес не заменил предыдущий:  
   **nmcli connection modify "static" +ipv4.dns 8.8.8.8**.  

4. Для изменения IP-адреса соединения выполнена команда  
   **nmcli connection modify "static" ipv4.addresses 10.0.0.20/24**.  
   После этого добавлен дополнительный IP-адрес **10.20.30.40/16**:  
   **nmcli connection modify "static" +ipv4.addresses 10.20.30.40/16**.  

   ![Изменение параметров соединения static](Screenshot_9.png){ #fig:009 width=80% }

5. После всех изменений соединение **static** было активировано с помощью команды  
   **nmcli connection up "static"**.  
   Проверка командой **nmcli connection show** подтвердила успешную активацию соединения.  
   Команда **ip addr** показала, что интерфейс **enp0s3** получил два IP-адреса — **10.0.0.20/24** и **10.20.30.40/16**.  

6. Для просмотра и редактирования параметров в текстовом интерфейсе **nmtui** был открыт раздел редактирования соединений.  
   На экране видно, что у профиля **static** вручную заданы адреса, шлюз **10.0.0.1** и два DNS-сервера — **10.0.0.10** и **8.8.8.8**.  

   ![Настройки соединения static в nmtui](Screenshot_10.png){ #fig:010 width=80% }

   Для профиля **dhcp** настройки IPv4 и IPv6 установлены в режим *Automatic*, а также включено автоподключение.  

   ![Настройки соединения dhcp в nmtui](Screenshot_11.png){ #fig:011 width=80% }

7. В графическом интерфейсе операционной системы были проверены параметры сетевых подключений.  
   Для соединения **static** указаны IP-адрес **10.20.30.40**, шлюз **10.0.0.1**, а также DNS-серверы **10.0.0.10** и **8.8.8.8**.  

   ![Просмотр настроек статического соединения в графическом интерфейсе](Screenshot_12.png){ #fig:012 width=80% }

   Для соединения **dhcp** показан динамически полученный адрес **10.0.2.15**, шлюз **10.0.2.2** и DNS **10.0.2.3**.  

   ![Просмотр настроек DHCP-профиля в графическом интерфейсе](Screenshot_13.png){ #fig:013 width=80% }

8. После проверки работы обоих профилей выполнено переключение обратно на исходное подключение:  
   **nmcli connection up "enp0s3"**.  
   Это вернуло систему к первоначальной конфигурации с динамическим IP-адресом.


# Контрольные вопросы

1. **Какая команда отображает только статус соединения, но не IP-адрес?**  
   nmcli device status  
   или  
   nmcli connection show --active  

2. **Какая служба управляет сетью в ОС типа RHEL?**  
   NetworkManager  

3. **Какой файл содержит имя узла (устройства) в ОС типа RHEL?**  
   /etc/hostname  

4. **Какая команда позволяет вам задать имя узла (устройства)?**  
   hostnamectl set-hostname <имя_узла>  

5. **Какой конфигурационный файл можно изменить для включения разрешения имён для конкретного IP-адреса?**  
   /etc/hosts  

6. **Какая команда показывает текущую конфигурацию маршрутизации?**  
   ip route show  

7. **Как проверить текущий статус службы NetworkManager?**  
   systemctl status NetworkManager  

8. **Какая команда позволяет вам изменить текущий IP-адрес и шлюз по умолчанию для вашего сетевого соединения?**  
   nmcli connection modify <имя_соединения> ipv4.addresses <адрес/маска> ipv4.gateway <шлюз>  

# Заключение

В ходе работы были изучены основные приёмы управления сетевыми настройками в Linux с использованием инструментов **nmcli**, **nmtui** и **NetworkManager**.  
Были выполнены задачи по созданию, изменению и активации сетевых профилей, добавлению статических и динамических IP-адресов, настройке DNS и шлюзов.  
Также была исследована работа графического и текстового интерфейсов управления сетью и методы проверки состояния подключений и маршрутов.
